!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/platform-browser"),require("rxjs/operators"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-doc-viewer",["exports","@angular/core","@angular/platform-browser","rxjs/operators","rxjs","@angular/common"],r):r((e=e||self)["ngx-doc-viewer"]={},e.ng.core,e.ng.platformBrowser,e.rxjs.operators,e.rxjs,e.ng.common)}(this,(function(e,r,n,t,i,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function l(e,r,n,t){return new(n||(n=Promise))((function(i,o){function l(e){try{a(t.next(e))}catch(e){o(e)}}function s(e){try{a(t.throw(e))}catch(e){o(e)}}function a(e){e.done?i(e.value):new n((function(r){r(e.value)})).then(l,s)}a((t=t.apply(e,r||[])).next())}))}function s(e,r){var n,t,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,t=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=l.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=r.call(e,l)}catch(e){o=[6,e],t=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var a=function(){function e(e,n){this.domSanitizer=e,this.ngZone=n,this.fullUrl=null,this.externalViewer=!1,this.docHtml="",this.configuredViewer="google",this.checkIFrameSubscription=null,this.loaded=new r.EventEmitter,this.url="",this.queryParams="",this.viewerUrl="",this.googleCheckInterval=3e3,this.disableContent="none",this.googleCheckContentLoaded=!0}return e.prototype.ngOnDestroy=function(){this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe()},e.prototype.ngOnChanges=function(e){return l(this,void 0,void 0,(function(){var r,n,o,l,a=this;return s(this,(function(s){switch(s.label){case 0:if(e&&e.viewer&&(e.viewer.isFirstChange||e.viewer.currentValue!==e.viewer.previousValue)&&("google"!==this.viewer&&"office"!==this.viewer&&"mammoth"!==this.viewer&&"pdf"!==this.viewer&&"url"!==this.viewer&&console.error("Unsupported viewer: '"+this.viewer+"'. Supported viewers: google, office, mammoth and pdf"),"mammoth"===this.viewer&&null===mammoth&&console.error("please install mammoth when using local viewer"),this.configuredViewer=this.viewer),"none"!==this.disableContent&&this.viewer,!(e.url&&e.url.currentValue!==e.url.previousValue||e.viewer&&e.viewer.currentValue!==e.viewer.previousValue||e.viewerUrl&&e.viewerUrl.currentValue!==e.viewerUrl.previousValue))return[3,4];switch(e.viewerUrl||(this.viewerUrl=null),this.configuredViewer){case"google":this.viewerUrl="https://docs.google.com/gview?url=%URL%&embedded=true";break;case"office":this.viewerUrl="https://view.officeapps.live.com/op/embed.aspx?src=%URL%";break;case"pdf":this.viewerUrl=null}return this.docHtml="",this.externalViewer="google"===this.configuredViewer||"office"===this.configuredViewer||"url"===this.configuredViewer,this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe(),this.url?[3,1]:(this.fullUrl=null,[3,4]);case 1:return"office"!==this.configuredViewer&&"google"!==this.configuredViewer&&"pdf"!==this.configuredViewer&&"url"!==this.configuredViewer?[3,2]:(r=this.url.indexOf("/")?encodeURIComponent(this.url):this.url,n=this.viewerUrl?this.viewerUrl.replace("%URL%",r):this.url,this.queryParams&&(o=this.queryParams.startsWith("&")?"":"&",n=""+n+o+this.queryParams),this.fullUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(n),"google"===this.configuredViewer&&this.googleCheckContentLoaded&&this.ngZone.runOutsideAngular((function(){var e,r=null===(e=a.iframes)||void 0===e?void 0:e.first.nativeElement;a.checkIFrame(r),a.checkIFrameSubscription=i.interval(a.googleCheckInterval).pipe(t.take(Math.round(0===a.googleCheckInterval?0:2e4/a.googleCheckInterval))).subscribe((function(){var e;null==r&&(r=null===(e=a.iframes)||void 0===e?void 0:e.first.nativeElement,a.checkIFrame(r)),a.reloadIFrame(r)}))})),[3,4]);case 2:return"mammoth"!==this.configuredViewer?[3,4]:(mammoth||console.error("Please install mammoth and make sure mammoth.browser.min.js is loaded."),l=this,[4,this.getDocxToHtml(this.url)]);case 3:l.docHtml=s.sent(),s.label=4;case 4:return[2]}}))}))},e.prototype.checkIFrame=function(e){var r=this;e&&(e.onload=function(){r.loaded.emit(null),r.checkIFrameSubscription&&r.checkIFrameSubscription.unsubscribe()})},e.prototype.reloadIFrame=function(e){e&&(console.log("reloading.."),e.src=e.src)},e.prototype.getDocxToHtml=function(e){return l(this,void 0,void 0,(function(){var r;return s(this,(function(n){switch(n.label){case 0:return[4,this.fileToArray(e)];case 1:return r=n.sent(),[4,mammoth.convertToHtml({arrayBuffer:r})];case 2:return[2,n.sent().value]}}))}))},e.prototype.fileToArray=function(e){return new Promise((function(r,n){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){var e=new FileReader;e.readAsArrayBuffer(t.response),e.onloadend=function(n){r(e.result)}},t.send()}catch(r){n("error while retrieving file "+e+".")}}))},e}();a.decorators=[{type:r.Component,args:[{selector:"ngx-doc-viewer",template:'<ng-container *ngIf="!externalViewer">\r\n    <div\r\n        *ngIf="configuredViewer !== \'pdf\'"\r\n        [innerHtml]="docHtml"\r\n    ></div>\r\n    <embed\r\n        *ngIf="configuredViewer === \'pdf\'"\r\n        type="application/pdf"\r\n        [src]="fullUrl"\r\n        style="width: 100%; height: 100%;"\r\n    />\r\n</ng-container>\r\n<ng-container *ngIf="externalViewer">\r\n    <iframe\r\n        *ngIf="fullUrl && disableContent === \'none\'"\r\n        #iframe\r\n        id="iframe"\r\n        frameBorder="0"\r\n        [src]="fullUrl"\r\n    ></iframe>\r\n    <div\r\n        class="container"\r\n        *ngIf="disableContent !== \'none\'"\r\n    >\r\n        <div\r\n            [class.overlay-full]="disableContent === \'all\'"\r\n            [class.overlay-popout-google]="configuredViewer ===\'google\' && (disableContent === \'popout\' || disableContent === \'popout-hide\')"\r\n            [class.overlay-popout-office]="configuredViewer ===\'office\' && (disableContent === \'popout\' || disableContent === \'popout-hide\')"\r\n            [style.background-color]="disableContent === \'popout-hide\' ? \'#fff\': \'transparent\'"\r\n        >\r\n        </div>\r\n        <iframe\r\n            *ngIf="fullUrl"\r\n            #iframe\r\n            id="iframe"\r\n            frameBorder="0"\r\n            [src]="fullUrl"\r\n        ></iframe>\r\n    </div>\r\n</ng-container>',styles:[":host {\n        display: block;\n    }\n    .container {\n        width: 100%;\n        height: 100%;\n        position: relative;\n    }\n    .overlay-popout-google {\n        width: 40px;\n        height: 40px;\n        right: 26px;\n        top: 11.5px;\n        position: absolute;\n        z-index: 1000;\n    }\n    .overlay-popout-office {\n        width: 100px;\n        height: 20px;\n        right: 0;\n        bottom: 0;\n        position: absolute;\n        z-index: 1000;\n    }\n    .overlay-full {\n        width: 100%;\n        height: 100%;\n        right: 0;\n        top: 0;\n        position: absolute;\n        z-index: 1000;\n    }\n    iframe {\n        width: 100%;\n        height: 100%;\n    }\n    "]}]}],a.ctorParameters=function(){return[{type:n.DomSanitizer},{type:r.NgZone}]},a.propDecorators={loaded:[{type:r.Output}],url:[{type:r.Input}],queryParams:[{type:r.Input}],viewerUrl:[{type:r.Input}],googleCheckInterval:[{type:r.Input}],disableContent:[{type:r.Input}],googleCheckContentLoaded:[{type:r.Input}],viewer:[{type:r.Input}],iframes:[{type:r.ViewChildren,args:["iframe"]}]};var u=function(){};u.decorators=[{type:r.NgModule,args:[{imports:[o.CommonModule],declarations:[a],exports:[a]}]}],e.NgxDocViewerComponent=a,e.NgxDocViewerModule=u,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-doc-viewer.umd.min.js.map